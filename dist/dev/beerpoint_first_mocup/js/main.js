"use strict";!function(){var getNowDate=function(){var get2Digits=function(target){return("0"+target).slice(-2)},nd=new Date,ndYear=nd.getFullYear(),ndMonth=nd.getMonth()+1,ndMonth2dig=get2Digits(ndMonth),ndDay2dig=get2Digits(nd.getDate()),ndHour2dig=get2Digits(nd.getHours()),ndMinutes2dig=get2Digits(nd.getMinutes()),ndSeconds2dig=get2Digits(nd.getSeconds());return{pointTitle:ndYear+"年"+ndMonth+"月",yearMonthForCompare:ndYear+ndMonth2dig.toString(),nowDate:ndYear+"-"+ndMonth2dig+"-"+ndDay2dig+" "+ndHour2dig+":"+ndMinutes2dig+":"+ndSeconds2dig}},headline=document.querySelector(".headline-date"),now=getNowDate();headline.innerText=now.pointTitle;try{var types=[{name:"beer",maxPoint:2},{name:"eatout",maxPoint:4}],typesLen=types.length,getTypeSettings=function(i){return{type:types[i].name,maxPoint:types[i].maxPoint,restPoint:types[i].name+"RestPoint",lastUsed:types[i].name+"LastUsed"}},lastLoginYM=localStorage.getItem("lastLoginYM"),loginYM=now.yearMonthForCompare;if(lastLoginYM&&lastLoginYM<loginYM){for(var i=0;i<typesLen;i++){var target=getTypeSettings(i);localStorage.setItem(target.restPoint,target.maxPoint)}alert("月が変わったのでポイントが回復しました。")}localStorage.setItem("lastLoginYM",loginYM);for(var _loop=function(_i){for(var target=getTypeSettings(_i),nowTargetPointNum=null==localStorage.getItem(target.restPoint)?target.maxPoint:localStorage.getItem(target.restPoint),lostTargetPointNum=target.maxPoint-nowTargetPointNum,targetPointSection=function(){for(var pointSections=document.querySelectorAll(".point"),pointSectionsLen=pointSections.length,_i2=0;_i2<pointSectionsLen;_i2++){if(pointSections[_i2].getAttribute("data-type")==target.type)return pointSections[_i2]}}(),targetPointObjects=targetPointSection.querySelectorAll(".point__life"),i_=1;i_<=lostTargetPointNum;i_++){var targetPointObj=targetPointObjects[target.maxPoint-i_],targetPointIcon=targetPointObj.querySelector(".point__icon");targetPointObj.classList.add("point__life--used"),targetPointIcon.style.display="none"}var lastUsed=localStorage.getItem(target.lastUsed);targetPointSection.querySelector(".point__last-used").innerText=lastUsed},_i=0;_i<typesLen;_i++)_loop(_i)}catch(e){alert("localStrage未対応のブラウザのため、ポイントの使用状況が保存されません。"),console.log("Error:"+e)}document.querySelector(".points").classList.remove("points--hidden");for(var pointBtns=document.querySelectorAll(".point__btn"),pointBtnsLen=pointBtns.length,_loop2=function(_i3){pointBtns[_i3].addEventListener("click",function(){var targetPoint=document.querySelectorAll(".point")[_i3],life=targetPoint.querySelectorAll(".point__life:not(.point__life--used)"),lifeLen=life.length;if(0!=lifeLen){var lastlife=life[lifeLen-1],lastlifeIcon=lastlife.querySelector(".point__icon");lastlife.classList.add("point__life--used"),lastlifeIcon.style.display="none";var usedText="前回は"+(now=getNowDate()).nowDate+"に使用しました。",targetLastUsed=targetPoint.querySelector(".point__last-used"),targetType=targetPoint.getAttribute("data-type"),targetRestPoint=targetType+"RestPoint",targetUsedTime=targetType+"LastUsed";targetLastUsed.innerText=usedText,localStorage.setItem(targetUsedTime,usedText);var restPoint=localStorage.getItem(targetRestPoint)-1;localStorage.setItem(targetRestPoint,restPoint)}else alert("残りポイントがありません。")})},_i3=0;_i3<pointBtnsLen;_i3++)_loop2(_i3)}();